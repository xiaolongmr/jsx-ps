# Photoshop 字体检测与替换工具

## 项目介绍
这是一个功能强大的Adobe Photoshop脚本，用于检测和批量替换文档中的字体。通过直观的界面，用户可以快速查看当前文档中所有文字图层使用的字体，并轻松进行批量替换操作，大大提高了设计工作的效率。

## 主要功能

1. **字体检测**：一键扫描当前打开的PSD文档，检测并列出所有文字图层使用的字体
2. **批量替换**：支持同时替换多个选中文字图层的字体
3. **灵活排序**：支持按文档顺序、字体分组、字体使用频率三种方式排序显示图层
4. **自定义显示**：可自定义字体显示格式，包括字体名称、文字内容、PostScript名称等
5. **智能选择**：支持自动选择相同字体的图层，以及反选、取消全选等操作
6. **友好名称**：提供更易读的字体友好名称，避免专业的PostScript名称带来的困扰
7. **用户偏好**：支持保存和加载用户偏好设置，包括显示格式、排序方式等
8. **操作日志**：提供控制台日志功能，记录所有操作历史
9. **撤销操作**：支持撤销上一步字体替换操作，包括连续多次撤销，直到所有操作都被撤销

## 安装方法

1. 下载 `FontSwapper.jsx` 文件到本地
2. 在 Photoshop 中，通过以下方式运行脚本：
   - 方法一：选择 `文件 > 脚本 > 浏览...`，然后选择下载的脚本文件
   - 方法二：将脚本文件复制到 Photoshop 安装目录下的 `Presets/Scripts` 文件夹中，重启 Photoshop 后，可在 `文件 > 脚本` 菜单中直接找到并运行

## 使用指南

### 基本使用流程
1. 在 Photoshop 中打开需要处理的 PSD 文件
2. 运行此脚本（方式见安装方法）
3. 脚本将自动检测文档中的所有文字图层并显示在界面上
4. 选择需要替换字体的文字图层（支持多选）
5. 在下拉菜单中选择要替换成的目标字体和样式
6. 点击「替换字体」按钮完成替换操作

### 高级操作

#### 图层选择技巧
- **多选图层**：使用 Ctrl+点击 选择不连续的多个图层，使用 Shift+点击 选择连续的多个图层
- **自动选择**：勾选「自动选中相同字体」复选框，点击任意图层时将自动选中所有使用相同字体的图层
- **反选**：点击「反选」按钮可快速反转当前所有图层的选中状态
- **取消选中**：点击「取消选中」按钮可快速取消所有图层的选中状态

#### 排序方式
在设置面板中可以选择以下排序方式：
- **按文档图层顺序**：按照图层在文档中出现的原始顺序显示
- **按相同字体分组**：将使用相同字体的图层分组显示，保持字体首次出现的顺序
- **按字体出现次数**：按照字体在文档中出现的频率排序，出现次数多的字体排在前面

#### 自定义显示格式
在设置面板中可以自定义字体信息的显示格式：
- 选择要显示的内容（字体名称、文字内容、PostScript名称）
- 调整显示内容的顺序
- 实时预览显示效果

## 界面说明

### 顶部工具栏
- **文档统计**：显示当前文档包含的文字图层数量和字体种类数量
- **设置首选项**：打开设置面板，自定义脚本行为
- **打赏作者**：支持作者继续开发和维护这个工具（点击可切换不同支持方式）

### 字体列表区域
- 显示文档中所有文字图层的字体信息
- 支持多选、自动选择相同字体等操作
- 显示选中状态统计信息

### 选择控制区域
- **自动选中相同字体**：启用后自动选择使用相同字体的图层
- **反选**：反转当前图层的选中状态
- **取消选中**：取消所有图层的选中状态

### 字体替换区域
- **字体家族下拉菜单**：选择要替换成的字体家族
- **样式下拉菜单**：选择字体的具体样式（如Regular、Bold等）
- **替换字体按钮**：执行字体替换操作
- **查看效果按钮**：关闭对话框查看效果

### 控制台日志与撤销功能（可选）
- 记录所有操作历史，包括替换操作的详细信息
- 提供「撤回上一步」按钮，可撤销最近一次字体替换操作
- 支持连续多次撤销，直到所有字体替换操作都被撤销
- 当没有可撤销操作时，系统会提示「已经撤回完所有操作了」
- 可在设置面板中控制显示/隐藏控制台日志区域

## 注意事项

1. 确保在运行脚本前已打开需要处理的PSD文件
2. 如果文档中没有文字图层，脚本将提示并退出
3. 替换字体时，请确保选择了要替换的图层和目标字体
4. 对于复杂的PSD文件，处理时间可能会稍长，请耐心等待
5. 建议在重要操作前保存文档，以防止意外情况发生

## 更新日志

### 版本 2.2
- 显示格式优化：统一了显示格式，现在友好字体名称使用"()"包裹，文字内容使用"[]"包裹

### 版本 2.1
- 增加了撤销功能，可撤销上一步字体替换操作
- 在控制台日志区域添加了「撤回上一步」按钮
- 支持连续多次撤销操作，直至所有替换操作都被撤销
- 优化了日志记录与撤销功能的同步机制

### 版本 2.0
- 重新设计了用户界面，提供更友好的交互体验
- 增加了多种排序方式和自定义显示选项
- 优化了字体检测和替换算法
- 增加了控制台日志功能
- 支持保存用户偏好设置
- 增加了更多实用功能，如自动选择相同字体、反选等

## 作者信息

- **作者网站**：www.z-l.top
- **首发地址**：[GetQuicker平台](https://getquicker.net/Sharedaction?code=6471ed9b-8254-443d-0267-08ddf9bab61f)
- **最后更新**：2025.9.27

## 许可证

本脚本开源，欢迎使用和分享。如有问题或建议，欢迎反馈给作者。